<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fetch API</title>
  </head>

  <body>
    <h1>Post will show here when you hit the button.</h1>

    <h1>Using : .then</h1>
    <button onclick="getRecentPost2()">click here</button>
    <div id="posts2"></div>
    <hr />

    <h1>Using : async await</h1>
    <button onclick="getRecentPost()">click here</button>
    <div id="posts"></div>

    <hr />
    <h1>Axios</h1>
    <button onclick="getRecentPost3()">click here</button>
    <div id="posts3"></div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      //1.  we can do the using .then if fetch returns the promise. if you want to know that fetch returns
      // promise or not then you can check it by console logging the response of fetch method
      function getRecentPost2() {
        const res1 = fetch("https://jsonplaceholder.typicode.com/posts/1");
        console.log(res1); // yeh promise return kr rha hai toh hum .then use kr skte hai
        res1.then(function (res2) {
          // ❌ No, fetch() always returns a Response object(not real object), not raw JSON. -->
          console.log(typeof res2); // object
          const jsonData = res2.json(); // yeh bhi promise return karta hai because it takes time to convert the response to json format so that can use .then with it
          jsonData.then(function (res3) {
            console.log(typeof res3); // object which is real.
            document.getElementById("posts2").innerHTML = res3.body; // yeh tab likhnge jab json ke under mein jab body chahiye
            // this how we can resolve promises if we are getting nested promises (promise inside promise)
            // we can use multiple nested .then (like res.then(function(){...})
          });
        });
      }

      //2.  this is using async await function to fetch the data from the server
      async function getRecentPost() {
        // yeh data fetch krega from the server using the fetch method and store krega response variable pe
        const response = await fetch(
          "https://jsonplaceholder.typicode.com/posts/1",
          {
            method: "GET",
          }
        );
        const data = await response.json(); // convert the response to json format
        document.getElementById("posts").innerHTML = data.body; //yeh tab likhnge jab json ke under mein jab body chahiye
        // hoga means kisi particular ko chahiye hoga toh dot(.) likh kr us attribute ka name likh denge
        // document.getElementById("posts").innerHTML = JSON.stringify(data) - yeh stringify tab use krenge jb pura
        // json data string ke form mein chahiye hoga
      }

      // 3. Axios : > with axios to handle promise we can use async await or .then both are fine
      async function getRecentPost3() {
          const response = await axios.get("https://jsonplaceholder.typicode.com/posts/1");
          console.log(typeof response); // real object 
          console.log(response.data); //  This is the actual data
          document.getElementById("posts3").innerHTML = response.data.body; // Display body in element with id 'posts2'
      }
    </script>
  </body>
</html>
